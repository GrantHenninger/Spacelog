{% extends "base.html" %}
{% load xappy %}
{% load missiontime %}
{% load characters %}

{% block content-class %}search{% endblock %}
{% block content %}
    <form method='get' action=''>
        <input type='text' name='q' value='{{ q|escape }}'>
        <input type='submit' value='Search'>
    </form>

    {% if log_lines %}
    <h1><span>Search </span>Results for &ldquo;{{ q }}&rdquo;</h1>
    {% else %}
    <h1>No <span>Search </span>results for &ldquo;{{ q }}&rdquo;</h1>
    
    <p>
      Sorry about that. Incidentally, Astronaut Fed Haise once had the same
      problem:
    </p>
    
    
    {% endif %}
    <!-- {{ debug.query }} -->
    
    <ol id="results">
        {% for log_line in log_lines %}
            <li>
                <h2>
                    {% avatar_and_name log_line.speaker log_line.timestamp %}
                    said
                    <a href="{% selection_url log_line.timestamp %}">
                        <q>{{ log_line.title|safe }}</q>
                    </a>
                </h2>
                <blockquote cite="{% selection_url log_line.timestamp %}"><p>{{ log_line.summary }}</p></blockquote>
                <dl>
                    <dt>Timestamp</dt>
                    <dd>
                      <a href="{% selection_url log_line.timestamp %}">
                        <time datetime="{{ log_line.utc_time|date:"Y-m-d\TH:i:s\Z" }}">
                            {{log_line.timestamp|mission_time_format}}
                        </time>
                      </a>
                    </dd>
                </dl>
            </li>
        {% endfor %}
    </ol>

    <div class="pagination">
    {% if previous_page %}
        <a href='{{ previous_page }}'>Previous<span> page</span></a>
    {% endif %}

    <ol>
        {% for page in pages %}
            <li>
                {% if page == "..." %}&hellip;{% else %}{% if page.selected %}{{ page.number }}{% else %}<a href='{{ page.url }}'>{{ page.number }}</a>{% endif %}{% endif %}
            </li>
        {% endfor %}
    </ol>

    {% if next_page %}
        <a href='{{ next_page }}'>Next<span> page</span></a>
    {% endif %}
    </div>
{% endblock %}
